<!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <!-- turn this into html5 -->
    <head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app13.us.archive.org';v.server_ms=159;archive_analytics.send_pageview({});});</script><script type="text/javascript" src="/_static/js/playback.bundle.js?v=R56vIgLu" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=cRqOKCOw" charset="utf-8"></script>
<script type="text/javascript">
if (window._WBWombatInit) {
  wbinfo = {}
  wbinfo.url = "http://www.uncarved.com/articles/svn_mail";
  wbinfo.timestamp = "20160512184054";
  wbinfo.request_ts = "20160512184054";
  wbinfo.prefix = "https://web.archive.org/web/";
  wbinfo.mod = "if_";
  wbinfo.is_framed = false;
  wbinfo.is_live = false;
  wbinfo.coll = "web";
  wbinfo.proxy_magic = "";
  wbinfo.static_prefix = "/_static/";
  wbinfo.enable_auto_fetch = true;
  wbinfo.auto_fetch_worker_prefix = "https://web.archive.org/web/";
  wbinfo.wombat_ts = "20160512184054";
  wbinfo.wombat_sec = "1463078454";
  wbinfo.wombat_scheme = "https";
  wbinfo.wombat_host = "www.uncarved.com";
  wbinfo.ignore_prefixes = ["/__wb/",
                            "/_static/",
                            "/web/",
                            "http://analytics.archive.org/",
                            "https://analytics.archive.org/",
                            "//analytics.archive.org/",
                            "http://archive.org/",
                            "https://archive.org/",
                            "//archive.org/",
                            "http://faq.web.archive.org/",
                            "http://web.archive.org/",
                            "https://web.archive.org/"
                            ];
  wbinfo.wombat_opts = {};
  window._WBWombatInit(wbinfo);
}
__wm.init("https://web.archive.org/web");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=_99BHQfY" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->

        <meta http-equiv="content-type" content="text/html;charset=utf-8"/>
        <meta name="Author" content="Sean Hunter"/>
        <meta name="MSSmartTagsPreventParsing" content="TRUE"/>
        <meta name="description" content="Moving my mail into subversion gives me easy backups  and all of my homedir in one place.  Here's how I did it."/>
		<link rel="stylesheet" type="text/css" href="/web/20160512184054cs_/http://www.uncarved.com/static/style.css"/>
        <link rel="self" type="text/html" href="http://www.uncarved.com/articles/svn_mail"/>
        <title>The Uncarved Blog: My life (and mail) in subversion</title>
	</head>

	<body>
		<div id="left_menu">
			<ul>
                <li><a href="https://web.archive.org/web/20160512184054/http://www.uncarved.com/articles/svn_mail">permalink</a></li>
                <li><a href="https://web.archive.org/web/20160512184054/http://www.uncarved.com/">top</a></li>
                
				<li><a href="/web/20160512184054/http://www.uncarved.com/articles/contact">contact me</a></li>
				<li><a href="/web/20160512184054/http://www.uncarved.com/login/" rel="nofollow">not logged in</a></li>
                
			</ul>
		</div>
		<div class="body">
            
			<h2>
                
                My life (and mail) in subversion
			</h2>
            

            
            <div class="precis">Moving my mail into subversion gives me easy backups  and all of my homedir in one place.  Here&#39;s how I did it.</div>
            

            <p>Inspired by <a href="https://web.archive.org/web/20160512184054/http://www.onlamp.com/pub/a/onlamp/2005/01/06/svn_homedir.html">'Keeping your life in subversion'</a> For some time now I have been slowly migrating all of my personal home directories into the <a href="https://web.archive.org/web/20160512184054/http://subversion.tigris.org/">subversion</a> version control system and merging back so that I end up with a spartan configuration and everything gets backed up.  Fool that I am, however, I want to take things one step further and also keep all of my mail in version control too.</p>
<p>The benefits of keeping mail in a version control system are marginal.  Mails are not typically edited after they are received and sent, so a lot of people use a system such as <a href="https://web.archive.org/web/20160512184054/http://www.linuxjournal.com/article/7712">unison</a> and find it more than adequate.  However, since everything else in my homedir is in subversion I wanted the mail in there too.  Happily for my purposes this is not too hard.</p>
<p>The first thing is that I wanted a simple script that I can run after I have read or filed my mail that indexes the mail and syncs it to subversion.  For indexing, I use <a href="https://web.archive.org/web/20160512184054/http://www.rc0.org.uk/mairix/">mairix</a>, which allows me to create virtual folders and cooperates well with <a href="https://web.archive.org/web/20160512184054/http://www.mutt.org/">mutt</a>, my favourite email client.  One possible solution to virtual folders is <a href="https://web.archive.org/web/20160512184054/http://larve.net/people/hugo/2003/scratchpad/VirtualFoldersInMutt.html">here</a>.  I decided to do things a little differently, and here's the shell script that does it all for me:</p>
<pre><code>#!/bin/sh

set -e

TODAY=$( date -Iseconds )
cd "${HOME}/mail"
echo "Updating mail index..."
mairix -p       #add '-v' for more verbosity
echo "Emptying search folder"
rm -rf "${HOME}/mail/mfolder/"{cur,new,tmp}/*
echo "svn syncup"
svn status | awk '/^\?/{print $2}' | xargs -r svn add
svn status | awk '/^!/{print $2}' | xargs -r svn rm
svn ci -m "Mail sync for ${TODAY}"
</code></pre>
<p>Here's my .mairixrc:</p>
<pre><code>base=/home/sean/mail
maildir=incoming...:sentmail...
mfolder=mfolder
database=/home/sean/mail/mairix_database
</code></pre>
<p>All that's needed to get it working in Mutt is to add <code>~/mail/mfolder</code> to the <code>mailboxes</code> my .muttrc, and add <code>macro index \e\/ "&lt;shell-escape&gt;mairix " "Run a mairix search"</code> at the same time.  Now, in mutt to do a search I do <code>Escape-/</code> and type a regex.  All of the hits are in ~/mail/mfolder and I change to that like a regular mailbox.</p>
<p>...and to keep it all up to date I just run my mailsync script every now and again.</p>
		<hr/>
        <p class="footer">
        
        <span id="tags">Tags:
            
            <a href="https://web.archive.org/web/20160512184054/http://www.uncarved.com/tags/computers">computers</a>
            
        </span>
        
        Last modified: 2006-05-18T16:26:32Z</p>
        <p class="tagline">Unless otherwise specified the contents of this page are copyright &copy; 2015 <a href="https://web.archive.org/web/20160512184054/mailto:sean@uncarved.com">Sean Hunter</a>.  This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International <a rel="license" href="https://web.archive.org/web/20160512184054/http://creativecommons.org/licenses/by-sa/4.0/">License</a>.
        <!-- figure out metadata -->
	</p>
		</div>
    </body>
</html><!--
     FILE ARCHIVED ON 18:40:54 May 12, 2016 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:01:08 Jul 30, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  exclusion.robots: 0.2
  captures_list: 107.597
  LoadShardBlock: 81.779 (3)
  PetaboxLoader3.datanode: 52.322 (4)
  exclusion.robots.policy: 0.186
  PetaboxLoader3.resolve: 59.826 (2)
  esindex: 0.015
  CDXLines.iter: 20.593 (3)
  RedisCDXSource: 1.811
  load_resource: 45.168
-->