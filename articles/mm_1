<!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <!-- turn this into html5 -->
    <head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app56.us.archive.org';v.server_ms=174;archive_analytics.send_pageview({});});</script><script type="text/javascript" src="/_static/js/playback.bundle.js?v=R56vIgLu" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=cRqOKCOw" charset="utf-8"></script>
<script type="text/javascript">
if (window._WBWombatInit) {
  wbinfo = {}
  wbinfo.url = "http://www.uncarved.com/articles/mm_1";
  wbinfo.timestamp = "20160512183946";
  wbinfo.request_ts = "20160512183946";
  wbinfo.prefix = "https://web.archive.org/web/";
  wbinfo.mod = "if_";
  wbinfo.is_framed = false;
  wbinfo.is_live = false;
  wbinfo.coll = "web";
  wbinfo.proxy_magic = "";
  wbinfo.static_prefix = "/_static/";
  wbinfo.enable_auto_fetch = true;
  wbinfo.auto_fetch_worker_prefix = "https://web.archive.org/web/";
  wbinfo.wombat_ts = "20160512183946";
  wbinfo.wombat_sec = "1463078386";
  wbinfo.wombat_scheme = "https";
  wbinfo.wombat_host = "www.uncarved.com";
  wbinfo.ignore_prefixes = ["/__wb/",
                            "/_static/",
                            "/web/",
                            "http://analytics.archive.org/",
                            "https://analytics.archive.org/",
                            "//analytics.archive.org/",
                            "http://archive.org/",
                            "https://archive.org/",
                            "//archive.org/",
                            "http://faq.web.archive.org/",
                            "http://web.archive.org/",
                            "https://web.archive.org/"
                            ];
  wbinfo.wombat_opts = {};
  window._WBWombatInit(wbinfo);
}
__wm.init("https://web.archive.org/web");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=_99BHQfY" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->

        <meta http-equiv="content-type" content="text/html;charset=utf-8"/>
        <meta name="Author" content="Sean Hunter"/>
        <meta name="MSSmartTagsPreventParsing" content="TRUE"/>
        <meta name="description" content="The first in a series of articles in which we will construct a simple high frequency trading system."/>
		<link rel="stylesheet" type="text/css" href="/web/20160512183946cs_/http://www.uncarved.com/static/style.css"/>
        <link rel="self" type="text/html" href="http://www.uncarved.com/articles/mm_1"/>
        <title>The Uncarved Blog: Writing an Automated Marketmaking System</title>
	</head>

	<body>
		<div id="left_menu">
			<ul>
                <li><a href="https://web.archive.org/web/20160512183946/http://www.uncarved.com/articles/mm_1">permalink</a></li>
                <li><a href="https://web.archive.org/web/20160512183946/http://www.uncarved.com/">top</a></li>
                
				<li><a href="/web/20160512183946/http://www.uncarved.com/articles/contact">contact me</a></li>
				<li><a href="/web/20160512183946/http://www.uncarved.com/login/" rel="nofollow">not logged in</a></li>
                
			</ul>
		</div>
		<div class="body">
            
			<h2>
                
                Writing an Automated Marketmaking System
			</h2>
            

            
            <div class="precis">The first in a series of articles in which we will construct a simple high frequency trading system.</div>
            

            <p>There has been a lot of press recently about the evils of high frequency
trading (HFT), with many commentators saying that HFT may well be the root of
the next big financial crisis.  The basis for this view is the increasing
importance of computerised market-making systems in providing liquidity to
markets, and the concern about what happens if these participants stop
providing this liquidity in the event of some sort of market panic.
Additionally, some commentators maintain that automated market makers are
trading in a manner that is to the detriment of other participants.</p>
<p>Rather than attempting to add more commentary to this debate, I'd like to
contribute in a practical way by widening the understanding of these systems so
that people can decide for themselves.  As such, this is going to be the first
in a series of articles during which we will build a fully-functional
electronic market-making system.  It's going to take a little while to develop
all the pieces, but since I have the first piece almost ready to go I think
it's time I came out with the introductory articles.  This series will mostly
be aimed at people with some computing background and interest in financial
markets but not assume any knowledge of how markets work.</p>
<h2>Caveats before we begin</h2>
<p>Nothing in these articles is going to constitute any sort of advice as to the
merits of investing in a particular product, or making markets using a
particular strategy.  If you follow the series you will acquire some bits of
software which can be used to construct an EMM (Electronic Market-Making)
system.  I won't make you pay for them, and if you use them, you may lose
money.  The software may have bugs or unintended features which cause you to
lose money.  I'm really sorry if that's the case.  You need to understand the
software and accept the consequences of what it does, because it will be
trading on your account.  You need to put in place any tests you require to
feel happy that it is performing according to your specifications.  You also
need to understand that in financial markets you are dealing with random
processes and as such even well-founded strategies can lead to losses.
Additionally, anything you make using this toolkit will need to be able to hold
it's own against other market participants who will be aiming to exploit it.
In any financial situation you need to do your own research and take
responsibility for what happens - this is no different.  Obviously you
shouldn't put more at risk than you can afford to lose, but it's your money,
and you need to decide whether this is right for you.</p>
<h2>Background - Marketmakers and liquidity</h2>
<p>It would be very cumbersome if every time you wanted to buy something you had
to find the person willing to sell exactly that quantity at that time and agree
a price, so generally when we buy or sell, a <a href="https://web.archive.org/web/20160512183946/http://www.investopedia.com/terms/m/marketmaker.asp" title="Another definition of a marketmaker.">marketmaker</a> actually takes the
other side of the trade, hoping to find someone else wanting the opposite
bargain later in the day.   The marketmaker makes money by charging a small
spread (ie they buy for lower than they sell for) in return for assuming the
risk of holding the position you have put them into until they are able to
unwind it by doing the opposite trade.  This risk is a function of the ease of
the unwind (how likely they are to be able to find someone to trade with) and
the <a href="https://web.archive.org/web/20160512183946/http://www.investopedia.com/terms/v/volatility.asp" title="What is volatility?">price volatility</a> of the asset.  So if you want to trade in a product
which has very low price volatility, and very high <a href="https://web.archive.org/web/20160512183946/http://www.investopedia.com/terms/l/liquidity.asp" title="What is meant by liquidity?">liquidity</a>, then it would
be easy for the marketmaker to find someone to trade out of their position
with, and they would not need to worry about the price moving too much while
they hold the asset, so you would expect the spread between the bid and ask
prices to be very low.  Conversely, high volatility and low liquidity assets
would normally have high spreads to compensate marketmakers for their higher
risk.</p>
<h2>Providing liquidity</h2>
<p>In the old days, the position of marketmaker was held only by exchange locals
who had to pay for the membership that allowed them to earn this spread, but
with the advent of <a href="https://web.archive.org/web/20160512183946/http://www.investopedia.com/terms/l/limitorderbook.asp" title="What is a limit order book?">limit order books</a>, anyone can provide
liquidity to many markets and expect to be compensated for it.  Our goal is to
write a computer system which will do this for us.  In order to do that, we
first need to understand how a limit order book works, and by way of an example
I'm going to jump right in and introduce the market we will use as the basis
for this whole series.</p>
<h2>Bullionvault</h2>
<p>The market we're going to use for our examples is <a href="https://web.archive.org/web/20160512183946/http://www.bullionvault.com/#HUNTSE" title="Bullionvault.com - an online gold market that encourages automated market making">bullionvault.com</a>, which
is in essence a physical gold and silver market, with all the actual metal held
in escrow in reserves in New York, London and Zurich, with seperate order books
in $, &pound; and &euro;.  If you sign up using that link I will make a small
referral fee (at no cost to you) from the commissions you pay to trade your
account, and that's I'm going to get for writing these articles.  Before you
sign up, you should of course, peruse the <a href="https://web.archive.org/web/20160512183946/http://www.bullionvault.com/help/index.do" title="Bullionvault on-line help">on-line help</a> so you understand
how their system works, and like any other investment, you should think
carefully about the risks involved.</p>
<h2>Understanding the order book</h2>
<p>If you go to the <a href="https://web.archive.org/web/20160512183946/http://www.bullionvault.com/#HUNTSE" title="Bullionvault.com - an online gold market that encourages automated market making">front page</a>, you can see the current <em>sell</em>
and <em>buy</em> prices for gold in the three locations in one currency (USD by
default).</p>
<p><img alt="Bullionvault USD gold touch prices" src="/web/20160512183946im_/http://www.uncarved.com/static/images/bvusdtouch.jpg"/></p>
<h2>The touch</h2>
<p>These prices are just the top of the order book - the so-called <em>touch</em> prices.
You would find more quantity available at different prices to buy or sell
further away in the book, but what the prices mean in this example is that if
you wanted to buy one troy ounce of gold in NYC it would cost you $1528, but if
you wanted to sell you would only get $1524, so the market spread is $4 per TOz
or $110 per kg if you live in the modern world.  We're going to use metric
units for these articles as teaching something as amazing as a modern computer
to think in Troy ounces (or any imperial units) is a great evil, like teaching
children arithmetic only by using Roman numerals or something.</p>
<h2>Bid and Offer</h2>
<p>We're also going to use some real market-making terminology, so we're going to
refer to <em>bid and ask</em> or <em>bid and offer</em> prices, rather than <em>sell and buy</em>
prices.  The easy way to remember which way round these are is to think about
the fact that as marketmakers we want to make money and so charge people for
what they want to do.  If they want to sell, we're going to <em>bid</em> to buy those
shares from them at a low price.  If they want to sell, we will reluctantly
<em>offer</em> to sell to them at a high price.  Hence bid is low and offer is high.
When these prices are reversed, the orderbook is said to be <em>crossed</em>.  This
happens in equity markets when they are closed for the night, there is then an
auction phase where high bids are matched with low offers until the book is
uncrossed and normal trading begins.  We wouldn't expect the orderbook to be
crossed in a continuous trading market like this unless something was wrong and
matching was suspended.</p>
<h2>Aggressive and Passive</h2>
<p>If an order to buy comes in, and it has no limit price, it is matched with the
cheapest available sell orders until it is filled.  If it has a limit price, it
will only be filled up to the limit price on the order.  But what happens to
the remaining quantity?  Under normal circumstances, this quantity stays on the
book at the limit price until it can be matched against an incoming sell order
within its limit.</p>
<p>We say that an order that provides liquidity by sitting on the book waiting to
be filled is <em>passive</em> and that an order which crosses the spread, taking
liquidity from the market by crossing off with passive orders is <em>aggressive</em>.
We can also refer to the <em>passive touch</em> and <em>aggressive touch</em>.  If we have an
order to buy, then the <em>passive touch</em> is the bid and the <em>aggressive touch</em> is
the offer.  This is because if we want to buy passively, we will place our
order at the bid or lower, whereas if we want to buy aggressively, we will need
to pay the offer or higher.  The opposite would be true for a sell order.  If
we want to sell right now, we will need our limit price to be at, or more
aggressive (lower) than, the current bid, whereas if we are prepared to wait,
our price can be more passive (ie higher).</p>
<h2>Still to come - the software</h2>
<p>In the next article, I will introduce a the software we can use to connect to
bullionvault.  Please feel free to comment below if anything so far is unclear
and I'll try to deal with it in the next article.</p>
		<hr/>
        <p class="footer">
        
        <span id="tags">Tags:
            
            <a href="https://web.archive.org/web/20160512183946/http://www.uncarved.com/tags/computers">computers</a>
            
        </span>
        
        Last modified: 2011-05-11T09:59:07Z</p>
        <p class="tagline">Unless otherwise specified the contents of this page are copyright &copy; 2015 <a href="https://web.archive.org/web/20160512183946/mailto:sean@uncarved.com">Sean Hunter</a>.  This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International <a rel="license" href="https://web.archive.org/web/20160512183946/http://creativecommons.org/licenses/by-sa/4.0/">License</a>.
        <!-- figure out metadata -->
	</p>
		</div>
    </body>
</html><!--
     FILE ARCHIVED ON 18:39:46 May 12, 2016 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 06:54:06 Jul 30, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  RedisCDXSource: 2.728
  CDXLines.iter: 25.298 (3)
  exclusion.robots.policy: 0.147
  PetaboxLoader3.datanode: 52.325 (4)
  esindex: 0.009
  exclusion.robots: 0.159
  load_resource: 56.774
  PetaboxLoader3.resolve: 70.243 (2)
  captures_list: 110.743
  LoadShardBlock: 79.889 (3)
-->